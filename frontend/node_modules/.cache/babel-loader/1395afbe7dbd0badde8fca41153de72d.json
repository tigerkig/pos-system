{"ast":null,"code":"import _slicedToArray from \"E:/React/pos-system/main/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"E:/React/pos-system/main/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport * as React from 'react';\nimport { TimerBasedCleanupTracking } from '../../utils/cleanupTracking/TimerBasedCleanupTracking';\nimport { FinalizationRegistryBasedCleanupTracking } from '../../utils/cleanupTracking/FinalizationRegistryBasedCleanupTracking';\n/**\n * Signal to the underlying logic what version of the public component API\n * of the data grid is exposed.\n */\n\nvar GridSignature;\n\n(function (GridSignature) {\n  GridSignature[\"DataGrid\"] = \"DataGrid\";\n  GridSignature[\"DataGridPro\"] = \"DataGridPro\";\n})(GridSignature || (GridSignature = {})); // We use class to make it easier to detect in heap snapshots by name\n\n\nvar ObjectToBeRetainedByReact = function ObjectToBeRetainedByReact() {\n  _classCallCheck(this, ObjectToBeRetainedByReact);\n}; // Based on https://github.com/Bnaya/use-dispose-uncommitted/blob/main/src/finalization-registry-based-impl.ts\n// Check https://github.com/facebook/react/issues/15317 to get more information\n\n\nexport function createUseGridApiEventHandler(registryContainer) {\n  var cleanupTokensCounter = 0;\n  return function useGridApiEventHandler(apiRef, eventName, handler, options) {\n    if (registryContainer.registry === null) {\n      registryContainer.registry = typeof FinalizationRegistry !== 'undefined' ? new FinalizationRegistryBasedCleanupTracking() : new TimerBasedCleanupTracking();\n    }\n\n    var _React$useState = React.useState(new ObjectToBeRetainedByReact()),\n        _React$useState2 = _slicedToArray(_React$useState, 1),\n        objectRetainedByReact = _React$useState2[0];\n\n    var subscription = React.useRef(null);\n    var handlerRef = React.useRef();\n    handlerRef.current = handler;\n    var cleanupTokenRef = React.useRef(null);\n\n    if (!subscription.current && handlerRef.current) {\n      var enhancedHandler = function enhancedHandler(params, event, details) {\n        if (!event.defaultMuiPrevented) {\n          var _handlerRef$current;\n\n          (_handlerRef$current = handlerRef.current) == null ? void 0 : _handlerRef$current.call(handlerRef, params, event, details);\n        }\n      };\n\n      subscription.current = apiRef.current.subscribeEvent(eventName, enhancedHandler, options);\n      cleanupTokensCounter += 1;\n      cleanupTokenRef.current = {\n        cleanupToken: cleanupTokensCounter\n      };\n      registryContainer.registry.register(objectRetainedByReact, // The callback below will be called once this reference stops being retained\n      function () {\n        var _subscription$current;\n\n        (_subscription$current = subscription.current) == null ? void 0 : _subscription$current.call(subscription);\n        subscription.current = null;\n        cleanupTokenRef.current = null;\n      }, cleanupTokenRef.current);\n    } else if (!handlerRef.current && subscription.current) {\n      subscription.current();\n      subscription.current = null;\n\n      if (cleanupTokenRef.current) {\n        registryContainer.registry.unregister(cleanupTokenRef.current);\n        cleanupTokenRef.current = null;\n      }\n    }\n\n    React.useEffect(function () {\n      if (!subscription.current && handlerRef.current) {\n        var _enhancedHandler = function _enhancedHandler(params, event, details) {\n          if (!event.defaultMuiPrevented) {\n            var _handlerRef$current2;\n\n            (_handlerRef$current2 = handlerRef.current) == null ? void 0 : _handlerRef$current2.call(handlerRef, params, event, details);\n          }\n        };\n\n        subscription.current = apiRef.current.subscribeEvent(eventName, _enhancedHandler, options);\n      }\n\n      if (cleanupTokenRef.current && registryContainer.registry) {\n        // If the effect was called, it means that this render was committed\n        // so we can trust the cleanup function to remove the listener.\n        registryContainer.registry.unregister(cleanupTokenRef.current);\n        cleanupTokenRef.current = null;\n      }\n\n      return function () {\n        var _subscription$current2;\n\n        (_subscription$current2 = subscription.current) == null ? void 0 : _subscription$current2.call(subscription);\n        subscription.current = null;\n      };\n    }, [apiRef, eventName, options]);\n  };\n}\nvar registryContainer = {\n  registry: null\n}; // TODO: move to @mui/x-data-grid/internals\n// eslint-disable-next-line @typescript-eslint/naming-convention\n\nexport var unstable_resetCleanupTracking = function unstable_resetCleanupTracking() {\n  var _registryContainer$re;\n\n  (_registryContainer$re = registryContainer.registry) == null ? void 0 : _registryContainer$re.reset();\n  registryContainer.registry = null;\n};\nexport var useGridApiEventHandler = createUseGridApiEventHandler(registryContainer);\nvar optionsSubscriberOptions = {\n  isFirst: true\n};\nexport function useGridApiOptionHandler(apiRef, eventName, handler) {\n  // Validate that only one per event name?\n  useGridApiEventHandler(apiRef, eventName, handler, optionsSubscriberOptions);\n}\nexport { GridSignature };","map":{"version":3,"sources":["E:/React/pos-system/main/node_modules/@mui/x-data-grid/hooks/utils/useGridApiEventHandler.js"],"names":["React","TimerBasedCleanupTracking","FinalizationRegistryBasedCleanupTracking","GridSignature","ObjectToBeRetainedByReact","createUseGridApiEventHandler","registryContainer","cleanupTokensCounter","useGridApiEventHandler","apiRef","eventName","handler","options","registry","FinalizationRegistry","useState","objectRetainedByReact","subscription","useRef","handlerRef","current","cleanupTokenRef","enhancedHandler","params","event","details","defaultMuiPrevented","_handlerRef$current","call","subscribeEvent","cleanupToken","register","_subscription$current","unregister","useEffect","_handlerRef$current2","_subscription$current2","unstable_resetCleanupTracking","_registryContainer$re","reset","optionsSubscriberOptions","isFirst","useGridApiOptionHandler"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { TimerBasedCleanupTracking } from '../../utils/cleanupTracking/TimerBasedCleanupTracking';\nimport { FinalizationRegistryBasedCleanupTracking } from '../../utils/cleanupTracking/FinalizationRegistryBasedCleanupTracking';\n\n/**\n * Signal to the underlying logic what version of the public component API\n * of the data grid is exposed.\n */\nvar GridSignature;\n\n(function (GridSignature) {\n  GridSignature[\"DataGrid\"] = \"DataGrid\";\n  GridSignature[\"DataGridPro\"] = \"DataGridPro\";\n})(GridSignature || (GridSignature = {}));\n\n// We use class to make it easier to detect in heap snapshots by name\nclass ObjectToBeRetainedByReact {} // Based on https://github.com/Bnaya/use-dispose-uncommitted/blob/main/src/finalization-registry-based-impl.ts\n// Check https://github.com/facebook/react/issues/15317 to get more information\n\n\nexport function createUseGridApiEventHandler(registryContainer) {\n  let cleanupTokensCounter = 0;\n  return function useGridApiEventHandler(apiRef, eventName, handler, options) {\n    if (registryContainer.registry === null) {\n      registryContainer.registry = typeof FinalizationRegistry !== 'undefined' ? new FinalizationRegistryBasedCleanupTracking() : new TimerBasedCleanupTracking();\n    }\n\n    const [objectRetainedByReact] = React.useState(new ObjectToBeRetainedByReact());\n    const subscription = React.useRef(null);\n    const handlerRef = React.useRef();\n    handlerRef.current = handler;\n    const cleanupTokenRef = React.useRef(null);\n\n    if (!subscription.current && handlerRef.current) {\n      const enhancedHandler = (params, event, details) => {\n        if (!event.defaultMuiPrevented) {\n          var _handlerRef$current;\n\n          (_handlerRef$current = handlerRef.current) == null ? void 0 : _handlerRef$current.call(handlerRef, params, event, details);\n        }\n      };\n\n      subscription.current = apiRef.current.subscribeEvent(eventName, enhancedHandler, options);\n      cleanupTokensCounter += 1;\n      cleanupTokenRef.current = {\n        cleanupToken: cleanupTokensCounter\n      };\n      registryContainer.registry.register(objectRetainedByReact, // The callback below will be called once this reference stops being retained\n      () => {\n        var _subscription$current;\n\n        (_subscription$current = subscription.current) == null ? void 0 : _subscription$current.call(subscription);\n        subscription.current = null;\n        cleanupTokenRef.current = null;\n      }, cleanupTokenRef.current);\n    } else if (!handlerRef.current && subscription.current) {\n      subscription.current();\n      subscription.current = null;\n\n      if (cleanupTokenRef.current) {\n        registryContainer.registry.unregister(cleanupTokenRef.current);\n        cleanupTokenRef.current = null;\n      }\n    }\n\n    React.useEffect(() => {\n      if (!subscription.current && handlerRef.current) {\n        const enhancedHandler = (params, event, details) => {\n          if (!event.defaultMuiPrevented) {\n            var _handlerRef$current2;\n\n            (_handlerRef$current2 = handlerRef.current) == null ? void 0 : _handlerRef$current2.call(handlerRef, params, event, details);\n          }\n        };\n\n        subscription.current = apiRef.current.subscribeEvent(eventName, enhancedHandler, options);\n      }\n\n      if (cleanupTokenRef.current && registryContainer.registry) {\n        // If the effect was called, it means that this render was committed\n        // so we can trust the cleanup function to remove the listener.\n        registryContainer.registry.unregister(cleanupTokenRef.current);\n        cleanupTokenRef.current = null;\n      }\n\n      return () => {\n        var _subscription$current2;\n\n        (_subscription$current2 = subscription.current) == null ? void 0 : _subscription$current2.call(subscription);\n        subscription.current = null;\n      };\n    }, [apiRef, eventName, options]);\n  };\n}\nconst registryContainer = {\n  registry: null\n}; // TODO: move to @mui/x-data-grid/internals\n// eslint-disable-next-line @typescript-eslint/naming-convention\n\nexport const unstable_resetCleanupTracking = () => {\n  var _registryContainer$re;\n\n  (_registryContainer$re = registryContainer.registry) == null ? void 0 : _registryContainer$re.reset();\n  registryContainer.registry = null;\n};\nexport const useGridApiEventHandler = createUseGridApiEventHandler(registryContainer);\nconst optionsSubscriberOptions = {\n  isFirst: true\n};\nexport function useGridApiOptionHandler(apiRef, eventName, handler) {\n  // Validate that only one per event name?\n  useGridApiEventHandler(apiRef, eventName, handler, optionsSubscriberOptions);\n}\nexport { GridSignature };"]},"metadata":{},"sourceType":"module"}