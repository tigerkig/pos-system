{"ast":null,"code":"'use strict';\n\nvar $ = require('./$'),\n    LIBRARY = require('./$.library'),\n    global = require('./$.global'),\n    ctx = require('./$.ctx'),\n    classof = require('./$.classof'),\n    $export = require('./$.export'),\n    isObject = require('./$.is-object'),\n    anObject = require('./$.an-object'),\n    aFunction = require('./$.a-function'),\n    strictNew = require('./$.strict-new'),\n    forOf = require('./$.for-of'),\n    setProto = require('./$.set-proto').set,\n    same = require('./$.same-value'),\n    SPECIES = require('./$.wks')('species'),\n    speciesConstructor = require('./$.species-constructor'),\n    asap = require('./$.microtask'),\n    PROMISE = 'Promise',\n    process = global.process,\n    isNode = classof(process) == 'process',\n    P = global[PROMISE],\n    empty = function empty() {\n  /* empty */\n},\n    Wrapper;\n\nvar testResolve = function testResolve(sub) {\n  var test = new P(empty),\n      promise;\n  if (sub) test.constructor = function (exec) {\n    exec(empty, empty);\n  };\n  (promise = P.resolve(test))['catch'](empty);\n  return promise === test;\n};\n\nvar USE_NATIVE = function () {\n  var works = false;\n\n  function P2(x) {\n    var self = new P(x);\n    setProto(self, P2.prototype);\n    return self;\n  }\n\n  try {\n    works = P && P.resolve && testResolve();\n    setProto(P2, P);\n    P2.prototype = $.create(P.prototype, {\n      constructor: {\n        value: P2\n      }\n    }); // actual Firefox has broken subclass support, test that\n\n    if (!(P2.resolve(5).then(function () {}) instanceof P2)) {\n      works = false;\n    } // actual V8 bug, https://code.google.com/p/v8/issues/detail?id=4162\n\n\n    if (works && require('./$.descriptors')) {\n      var thenableThenGotten = false;\n      P.resolve($.setDesc({}, 'then', {\n        get: function get() {\n          thenableThenGotten = true;\n        }\n      }));\n      works = thenableThenGotten;\n    }\n  } catch (e) {\n    works = false;\n  }\n\n  return works;\n}(); // helpers\n\n\nvar sameConstructor = function sameConstructor(a, b) {\n  // library wrapper special case\n  if (LIBRARY && a === P && b === Wrapper) return true;\n  return same(a, b);\n};\n\nvar getConstructor = function getConstructor(C) {\n  var S = anObject(C)[SPECIES];\n  return S != undefined ? S : C;\n};\n\nvar isThenable = function isThenable(it) {\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\n\nvar PromiseCapability = function PromiseCapability(C) {\n  var resolve, reject;\n  this.promise = new C(function ($$resolve, $$reject) {\n    if (resolve !== undefined || reject !== undefined) throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject = $$reject;\n  });\n  this.resolve = aFunction(resolve), this.reject = aFunction(reject);\n};\n\nvar perform = function perform(exec) {\n  try {\n    exec();\n  } catch (e) {\n    return {\n      error: e\n    };\n  }\n};\n\nvar notify = function notify(record, isReject) {\n  if (record.n) return;\n  record.n = true;\n  var chain = record.c;\n  asap(function () {\n    var value = record.v,\n        ok = record.s == 1,\n        i = 0;\n\n    var run = function run(reaction) {\n      var handler = ok ? reaction.ok : reaction.fail,\n          resolve = reaction.resolve,\n          reject = reaction.reject,\n          result,\n          then;\n\n      try {\n        if (handler) {\n          if (!ok) record.h = true;\n          result = handler === true ? value : handler(value);\n\n          if (result === reaction.promise) {\n            reject(TypeError('Promise-chain cycle'));\n          } else if (then = isThenable(result)) {\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch (e) {\n        reject(e);\n      }\n    };\n\n    while (chain.length > i) {\n      run(chain[i++]);\n    } // variable length - can't use forEach\n\n\n    chain.length = 0;\n    record.n = false;\n    if (isReject) setTimeout(function () {\n      var promise = record.p,\n          handler,\n          console;\n\n      if (isUnhandled(promise)) {\n        if (isNode) {\n          process.emit('unhandledRejection', value, promise);\n        } else if (handler = global.onunhandledrejection) {\n          handler({\n            promise: promise,\n            reason: value\n          });\n        } else if ((console = global.console) && console.error) {\n          console.error('Unhandled promise rejection', value);\n        }\n      }\n\n      record.a = undefined;\n    }, 1);\n  });\n};\n\nvar isUnhandled = function isUnhandled(promise) {\n  var record = promise._d,\n      chain = record.a || record.c,\n      i = 0,\n      reaction;\n  if (record.h) return false;\n\n  while (chain.length > i) {\n    reaction = chain[i++];\n    if (reaction.fail || !isUnhandled(reaction.promise)) return false;\n  }\n\n  return true;\n};\n\nvar $reject = function $reject(value) {\n  var record = this;\n  if (record.d) return;\n  record.d = true;\n  record = record.r || record; // unwrap\n\n  record.v = value;\n  record.s = 2;\n  record.a = record.c.slice();\n  notify(record, true);\n};\n\nvar $resolve = function $resolve(value) {\n  var record = this,\n      then;\n  if (record.d) return;\n  record.d = true;\n  record = record.r || record; // unwrap\n\n  try {\n    if (record.p === value) throw TypeError(\"Promise can't be resolved itself\");\n\n    if (then = isThenable(value)) {\n      asap(function () {\n        var wrapper = {\n          r: record,\n          d: false\n        }; // wrap\n\n        try {\n          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n        } catch (e) {\n          $reject.call(wrapper, e);\n        }\n      });\n    } else {\n      record.v = value;\n      record.s = 1;\n      notify(record, false);\n    }\n  } catch (e) {\n    $reject.call({\n      r: record,\n      d: false\n    }, e); // wrap\n  }\n}; // constructor polyfill\n\n\nif (!USE_NATIVE) {\n  // 25.4.3.1 Promise(executor)\n  P = function Promise(executor) {\n    aFunction(executor);\n    var record = this._d = {\n      p: strictNew(this, P, PROMISE),\n      // <- promise\n      c: [],\n      // <- awaiting reactions\n      a: undefined,\n      // <- checked in isUnhandled reactions\n      s: 0,\n      // <- state\n      d: false,\n      // <- done\n      v: undefined,\n      // <- value\n      h: false,\n      // <- handled rejection\n      n: false // <- notify\n\n    };\n\n    try {\n      executor(ctx($resolve, record, 1), ctx($reject, record, 1));\n    } catch (err) {\n      $reject.call(record, err);\n    }\n  };\n\n  require('./$.redefine-all')(P.prototype, {\n    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)\n    then: function then(onFulfilled, onRejected) {\n      var reaction = new PromiseCapability(speciesConstructor(this, P)),\n          promise = reaction.promise,\n          record = this._d;\n      reaction.ok = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail = typeof onRejected == 'function' && onRejected;\n      record.c.push(reaction);\n      if (record.a) record.a.push(reaction);\n      if (record.s) notify(record, false);\n      return promise;\n    },\n    // 25.4.5.1 Promise.prototype.catch(onRejected)\n    'catch': function _catch(onRejected) {\n      return this.then(undefined, onRejected);\n    }\n  });\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, {\n  Promise: P\n});\n\nrequire('./$.set-to-string-tag')(P, PROMISE);\n\nrequire('./$.set-species')(PROMISE);\n\nWrapper = require('./$.core')[PROMISE]; // statics\n\n$export($export.S + $export.F * !USE_NATIVE, PROMISE, {\n  // 25.4.4.5 Promise.reject(r)\n  reject: function reject(r) {\n    var capability = new PromiseCapability(this),\n        $$reject = capability.reject;\n    $$reject(r);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * (!USE_NATIVE || testResolve(true)), PROMISE, {\n  // 25.4.4.6 Promise.resolve(x)\n  resolve: function resolve(x) {\n    // instanceof instead of internal slot check because we should fix it without replacement native Promise core\n    if (x instanceof P && sameConstructor(x.constructor, this)) return x;\n    var capability = new PromiseCapability(this),\n        $$resolve = capability.resolve;\n    $$resolve(x);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * !(USE_NATIVE && require('./$.iter-detect')(function (iter) {\n  P.all(iter)['catch'](function () {});\n})), PROMISE, {\n  // 25.4.4.1 Promise.all(iterable)\n  all: function all(iterable) {\n    var C = getConstructor(this),\n        capability = new PromiseCapability(C),\n        resolve = capability.resolve,\n        reject = capability.reject,\n        values = [];\n    var abrupt = perform(function () {\n      forOf(iterable, false, values.push, values);\n      var remaining = values.length,\n          results = Array(remaining);\n      if (remaining) $.each.call(values, function (promise, index) {\n        var alreadyCalled = false;\n        C.resolve(promise).then(function (value) {\n          if (alreadyCalled) return;\n          alreadyCalled = true;\n          results[index] = value;\n          --remaining || resolve(results);\n        }, reject);\n      });else resolve(results);\n    });\n    if (abrupt) reject(abrupt.error);\n    return capability.promise;\n  },\n  // 25.4.4.4 Promise.race(iterable)\n  race: function race(iterable) {\n    var C = getConstructor(this),\n        capability = new PromiseCapability(C),\n        reject = capability.reject;\n    var abrupt = perform(function () {\n      forOf(iterable, false, function (promise) {\n        C.resolve(promise).then(capability.resolve, reject);\n      });\n    });\n    if (abrupt) reject(abrupt.error);\n    return capability.promise;\n  }\n});","map":{"version":3,"sources":["E:/React/pos-system/main/node_modules/babel/node_modules/core-js/modules/es6.promise.js"],"names":["$","require","LIBRARY","global","ctx","classof","$export","isObject","anObject","aFunction","strictNew","forOf","setProto","set","same","SPECIES","speciesConstructor","asap","PROMISE","process","isNode","P","empty","Wrapper","testResolve","sub","test","promise","constructor","exec","resolve","USE_NATIVE","works","P2","x","self","prototype","create","value","then","thenableThenGotten","setDesc","get","e","sameConstructor","a","b","getConstructor","C","S","undefined","isThenable","it","PromiseCapability","reject","$$resolve","$$reject","TypeError","perform","error","notify","record","isReject","n","chain","c","v","ok","s","i","run","reaction","handler","fail","result","h","call","length","setTimeout","p","console","isUnhandled","emit","onunhandledrejection","reason","_d","$reject","d","r","slice","$resolve","wrapper","Promise","executor","err","onFulfilled","onRejected","push","G","W","F","capability","iter","all","iterable","values","abrupt","remaining","results","Array","each","index","alreadyCalled","race"],"mappings":"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","sourcesContent":["'use strict';\nvar $          = require('./$')\n  , LIBRARY    = require('./$.library')\n  , global     = require('./$.global')\n  , ctx        = require('./$.ctx')\n  , classof    = require('./$.classof')\n  , $export    = require('./$.export')\n  , isObject   = require('./$.is-object')\n  , anObject   = require('./$.an-object')\n  , aFunction  = require('./$.a-function')\n  , strictNew  = require('./$.strict-new')\n  , forOf      = require('./$.for-of')\n  , setProto   = require('./$.set-proto').set\n  , same       = require('./$.same-value')\n  , SPECIES    = require('./$.wks')('species')\n  , speciesConstructor = require('./$.species-constructor')\n  , asap       = require('./$.microtask')\n  , PROMISE    = 'Promise'\n  , process    = global.process\n  , isNode     = classof(process) == 'process'\n  , P          = global[PROMISE]\n  , empty      = function(){ /* empty */ }\n  , Wrapper;\n\nvar testResolve = function(sub){\n  var test = new P(empty), promise;\n  if(sub)test.constructor = function(exec){\n    exec(empty, empty);\n  };\n  (promise = P.resolve(test))['catch'](empty);\n  return promise === test;\n};\n\nvar USE_NATIVE = function(){\n  var works = false;\n  function P2(x){\n    var self = new P(x);\n    setProto(self, P2.prototype);\n    return self;\n  }\n  try {\n    works = P && P.resolve && testResolve();\n    setProto(P2, P);\n    P2.prototype = $.create(P.prototype, {constructor: {value: P2}});\n    // actual Firefox has broken subclass support, test that\n    if(!(P2.resolve(5).then(function(){}) instanceof P2)){\n      works = false;\n    }\n    // actual V8 bug, https://code.google.com/p/v8/issues/detail?id=4162\n    if(works && require('./$.descriptors')){\n      var thenableThenGotten = false;\n      P.resolve($.setDesc({}, 'then', {\n        get: function(){ thenableThenGotten = true; }\n      }));\n      works = thenableThenGotten;\n    }\n  } catch(e){ works = false; }\n  return works;\n}();\n\n// helpers\nvar sameConstructor = function(a, b){\n  // library wrapper special case\n  if(LIBRARY && a === P && b === Wrapper)return true;\n  return same(a, b);\n};\nvar getConstructor = function(C){\n  var S = anObject(C)[SPECIES];\n  return S != undefined ? S : C;\n};\nvar isThenable = function(it){\n  var then;\n  return isObject(it) && typeof (then = it.then) == 'function' ? then : false;\n};\nvar PromiseCapability = function(C){\n  var resolve, reject;\n  this.promise = new C(function($$resolve, $$reject){\n    if(resolve !== undefined || reject !== undefined)throw TypeError('Bad Promise constructor');\n    resolve = $$resolve;\n    reject  = $$reject;\n  });\n  this.resolve = aFunction(resolve),\n  this.reject  = aFunction(reject)\n};\nvar perform = function(exec){\n  try {\n    exec();\n  } catch(e){\n    return {error: e};\n  }\n};\nvar notify = function(record, isReject){\n  if(record.n)return;\n  record.n = true;\n  var chain = record.c;\n  asap(function(){\n    var value = record.v\n      , ok    = record.s == 1\n      , i     = 0;\n    var run = function(reaction){\n      var handler = ok ? reaction.ok : reaction.fail\n        , resolve = reaction.resolve\n        , reject  = reaction.reject\n        , result, then;\n      try {\n        if(handler){\n          if(!ok)record.h = true;\n          result = handler === true ? value : handler(value);\n          if(result === reaction.promise){\n            reject(TypeError('Promise-chain cycle'));\n          } else if(then = isThenable(result)){\n            then.call(result, resolve, reject);\n          } else resolve(result);\n        } else reject(value);\n      } catch(e){\n        reject(e);\n      }\n    };\n    while(chain.length > i)run(chain[i++]); // variable length - can't use forEach\n    chain.length = 0;\n    record.n = false;\n    if(isReject)setTimeout(function(){\n      var promise = record.p\n        , handler, console;\n      if(isUnhandled(promise)){\n        if(isNode){\n          process.emit('unhandledRejection', value, promise);\n        } else if(handler = global.onunhandledrejection){\n          handler({promise: promise, reason: value});\n        } else if((console = global.console) && console.error){\n          console.error('Unhandled promise rejection', value);\n        }\n      } record.a = undefined;\n    }, 1);\n  });\n};\nvar isUnhandled = function(promise){\n  var record = promise._d\n    , chain  = record.a || record.c\n    , i      = 0\n    , reaction;\n  if(record.h)return false;\n  while(chain.length > i){\n    reaction = chain[i++];\n    if(reaction.fail || !isUnhandled(reaction.promise))return false;\n  } return true;\n};\nvar $reject = function(value){\n  var record = this;\n  if(record.d)return;\n  record.d = true;\n  record = record.r || record; // unwrap\n  record.v = value;\n  record.s = 2;\n  record.a = record.c.slice();\n  notify(record, true);\n};\nvar $resolve = function(value){\n  var record = this\n    , then;\n  if(record.d)return;\n  record.d = true;\n  record = record.r || record; // unwrap\n  try {\n    if(record.p === value)throw TypeError(\"Promise can't be resolved itself\");\n    if(then = isThenable(value)){\n      asap(function(){\n        var wrapper = {r: record, d: false}; // wrap\n        try {\n          then.call(value, ctx($resolve, wrapper, 1), ctx($reject, wrapper, 1));\n        } catch(e){\n          $reject.call(wrapper, e);\n        }\n      });\n    } else {\n      record.v = value;\n      record.s = 1;\n      notify(record, false);\n    }\n  } catch(e){\n    $reject.call({r: record, d: false}, e); // wrap\n  }\n};\n\n// constructor polyfill\nif(!USE_NATIVE){\n  // 25.4.3.1 Promise(executor)\n  P = function Promise(executor){\n    aFunction(executor);\n    var record = this._d = {\n      p: strictNew(this, P, PROMISE),         // <- promise\n      c: [],                                  // <- awaiting reactions\n      a: undefined,                           // <- checked in isUnhandled reactions\n      s: 0,                                   // <- state\n      d: false,                               // <- done\n      v: undefined,                           // <- value\n      h: false,                               // <- handled rejection\n      n: false                                // <- notify\n    };\n    try {\n      executor(ctx($resolve, record, 1), ctx($reject, record, 1));\n    } catch(err){\n      $reject.call(record, err);\n    }\n  };\n  require('./$.redefine-all')(P.prototype, {\n    // 25.4.5.3 Promise.prototype.then(onFulfilled, onRejected)\n    then: function then(onFulfilled, onRejected){\n      var reaction = new PromiseCapability(speciesConstructor(this, P))\n        , promise  = reaction.promise\n        , record   = this._d;\n      reaction.ok   = typeof onFulfilled == 'function' ? onFulfilled : true;\n      reaction.fail = typeof onRejected == 'function' && onRejected;\n      record.c.push(reaction);\n      if(record.a)record.a.push(reaction);\n      if(record.s)notify(record, false);\n      return promise;\n    },\n    // 25.4.5.1 Promise.prototype.catch(onRejected)\n    'catch': function(onRejected){\n      return this.then(undefined, onRejected);\n    }\n  });\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, {Promise: P});\nrequire('./$.set-to-string-tag')(P, PROMISE);\nrequire('./$.set-species')(PROMISE);\nWrapper = require('./$.core')[PROMISE];\n\n// statics\n$export($export.S + $export.F * !USE_NATIVE, PROMISE, {\n  // 25.4.4.5 Promise.reject(r)\n  reject: function reject(r){\n    var capability = new PromiseCapability(this)\n      , $$reject   = capability.reject;\n    $$reject(r);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * (!USE_NATIVE || testResolve(true)), PROMISE, {\n  // 25.4.4.6 Promise.resolve(x)\n  resolve: function resolve(x){\n    // instanceof instead of internal slot check because we should fix it without replacement native Promise core\n    if(x instanceof P && sameConstructor(x.constructor, this))return x;\n    var capability = new PromiseCapability(this)\n      , $$resolve  = capability.resolve;\n    $$resolve(x);\n    return capability.promise;\n  }\n});\n$export($export.S + $export.F * !(USE_NATIVE && require('./$.iter-detect')(function(iter){\n  P.all(iter)['catch'](function(){});\n})), PROMISE, {\n  // 25.4.4.1 Promise.all(iterable)\n  all: function all(iterable){\n    var C          = getConstructor(this)\n      , capability = new PromiseCapability(C)\n      , resolve    = capability.resolve\n      , reject     = capability.reject\n      , values     = [];\n    var abrupt = perform(function(){\n      forOf(iterable, false, values.push, values);\n      var remaining = values.length\n        , results   = Array(remaining);\n      if(remaining)$.each.call(values, function(promise, index){\n        var alreadyCalled = false;\n        C.resolve(promise).then(function(value){\n          if(alreadyCalled)return;\n          alreadyCalled = true;\n          results[index] = value;\n          --remaining || resolve(results);\n        }, reject);\n      });\n      else resolve(results);\n    });\n    if(abrupt)reject(abrupt.error);\n    return capability.promise;\n  },\n  // 25.4.4.4 Promise.race(iterable)\n  race: function race(iterable){\n    var C          = getConstructor(this)\n      , capability = new PromiseCapability(C)\n      , reject     = capability.reject;\n    var abrupt = perform(function(){\n      forOf(iterable, false, function(promise){\n        C.resolve(promise).then(capability.resolve, reject);\n      });\n    });\n    if(abrupt)reject(abrupt.error);\n    return capability.promise;\n  }\n});"]},"metadata":{},"sourceType":"script"}