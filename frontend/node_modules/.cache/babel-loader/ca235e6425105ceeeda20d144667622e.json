{"ast":null,"code":"(function (w) {\n  var index = 1;\n  var init = false;\n  var widgets = {};\n  var widgetsConfig = {};\n  var createQueue = [];\n\n  if (typeof w.addEventListener === 'function') {\n    w.addEventListener('resize', function () {\n      updateWidgetSize();\n    });\n  } else {\n    var onresizeHandler = w.onresize;\n\n    w.onresize = function (event) {\n      try {\n        if (typeof onresizeHandler === 'function') {\n          onresizeHandler(event);\n        }\n      } finally {\n        updateWidgetSize();\n      }\n    };\n  }\n\n  w.getPreview = getPreview;\n\n  w.preview = function (widgetName, node, properties, undefined) {\n    switch (widgetName) {\n      case 'products':\n        createQueue.push({\n          type: 'productsPreview',\n          properties: properties,\n          node: node,\n          index: index\n        });\n        break;\n\n      case 'categories':\n        createQueue.push({\n          type: 'categoriesPreview',\n          properties: properties,\n          node: node,\n          index: index\n        });\n        break;\n\n      case 'productDetails':\n        createQueue.push({\n          type: 'productDetailsPreview',\n          properties: properties,\n          node: node,\n          index: index\n        });\n        break;\n\n      case 'externalDataProductDetails':\n        createQueue.push({\n          type: 'externalDataProductDetailsPreview',\n          properties: properties,\n          node: node,\n          index: index\n        });\n        break;\n\n      default:\n    }\n\n    if (init) {\n      load();\n    }\n\n    return index++;\n  };\n\n  w.previewCustomize = function (widgetIndex, config) {\n    if (typeof config != typeof {}) {\n      return;\n    }\n\n    widgetsConfig[widgetIndex] = config;\n    return sendLookAndFeelConfig(widgetIndex, config);\n  };\n\n  w.updatePreviewStoreConfiguration = function (widgetIndex, config) {\n    if (typeof config != typeof {}) {\n      return;\n    }\n\n    return sendPreviewStoreConfiguration(widgetIndex, config);\n  };\n\n  w.updateExternalDataProductDetails = function (widgetIndex, externalProductData) {\n    if (typeof externalProductData != typeof {}) {\n      return;\n    }\n\n    return sendExternalProductData(widgetIndex, externalProductData);\n  };\n\n  w.updatePreviewWidgetSize = updateWidgetSize; //  if (!w.ec) {\n  //      w.ec = {\n  //          getString: function(key) {\n  //              return rosettaMessages['new-frontend'][key];\n  //          }\n  //      }\n  //  }\n\n  function sendLookAndFeelConfig(widgetIndex, config) {\n    var preview = getPreview(widgetIndex);\n\n    if (!preview) {\n      return false;\n    }\n\n    if (preview.ports.overrideStorefrontLookAndFeel) {\n      preview.ports.overrideStorefrontLookAndFeel.send(JSON.stringify(config));\n    }\n\n    return true;\n  }\n\n  function sendPreviewStoreConfiguration(widgetIndex, storeConfig) {\n    var preview = getPreview(widgetIndex);\n\n    if (!preview) {\n      return false;\n    }\n\n    if (preview.ports.configResponse) {\n      preview.ports.configResponse.send(JSON.stringify(storeConfig));\n    }\n\n    return true;\n  }\n\n  function sendExternalProductData(widgetIndex, externalProductData) {\n    var preview = getPreview(widgetIndex);\n\n    if (!preview) {\n      return false;\n    }\n\n    if (preview.ports.productResponse) {\n      preview.ports.productResponse.send(JSON.stringify(externalProductData));\n    }\n\n    return true;\n  }\n\n  function load() {\n    updateWidgetSize();\n  }\n\n  function updateWidgetSize() {\n    for (var property in widgets) {\n      if (widgets.hasOwnProperty(property)) {\n        var node = widgets[property].node;\n        var preview = getPreview(property);\n        preview.ports.onContainerResize.send(JSON.stringify({\n          browserWidth: node.offsetWidth\n        }));\n      }\n    }\n  }\n\n  function getPreview(id) {\n    return widgets[id] && widgets[id].preview;\n  }\n})(window);","map":{"version":3,"sources":["E:/React/pos-system/main/src/views/online/preview.js"],"names":["w","index","init","widgets","widgetsConfig","createQueue","addEventListener","updateWidgetSize","onresizeHandler","onresize","event","getPreview","preview","widgetName","node","properties","undefined","push","type","load","previewCustomize","widgetIndex","config","sendLookAndFeelConfig","updatePreviewStoreConfiguration","sendPreviewStoreConfiguration","updateExternalDataProductDetails","externalProductData","sendExternalProductData","updatePreviewWidgetSize","ports","overrideStorefrontLookAndFeel","send","JSON","stringify","storeConfig","configResponse","productResponse","property","hasOwnProperty","onContainerResize","browserWidth","offsetWidth","id","window"],"mappings":"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","sourcesContent":["(function(w) {\r\n\r\n     var index =1;\r\n     var init = false;\r\n     var widgets = {};\r\n     var widgetsConfig = {};\r\n     var createQueue = [];\r\n \r\n     if (typeof w.addEventListener === 'function') {\r\n         w.addEventListener('resize', function() {\r\n             updateWidgetSize();\r\n         });\r\n     } else {\r\n         var onresizeHandler = w.onresize;\r\n         w.onresize = function(event) {\r\n             try {\r\n                 if (typeof onresizeHandler === 'function') {\r\n                     onresizeHandler(event);\r\n                 }\r\n             }\r\n             finally {\r\n                 updateWidgetSize();\r\n             }\r\n         }\r\n     }\r\n \r\n     w.getPreview = getPreview\r\n \r\n     w.preview = function(widgetName, node, properties, undefined) {\r\n         switch (widgetName) {\r\n             case 'products':\r\n                 createQueue.push({type:'productsPreview', properties : properties, node: node, index: index});\r\n \r\n                 break;\r\n             case 'categories':\r\n                 createQueue.push({type:'categoriesPreview', properties : properties, node: node, index: index});\r\n                 break;\r\n \r\n             case 'productDetails':\r\n                 createQueue.push({type:'productDetailsPreview', properties: properties, node: node, index: index});\r\n                 break;\r\n \r\n             case 'externalDataProductDetails':\r\n                 createQueue.push({type:'externalDataProductDetailsPreview', properties: properties, node: node, index: index});\r\n                 break;\r\n \r\n             default:\r\n         }\r\n         if (init) {\r\n             load();\r\n         }\r\n         return index++;\r\n     }\r\n \r\n     w.previewCustomize = function(widgetIndex, config) {\r\n         if (typeof config != typeof {}) {\r\n             return;\r\n         }\r\n         widgetsConfig[widgetIndex] = config;\r\n         return sendLookAndFeelConfig(widgetIndex, config);\r\n     }\r\n \r\n     w.updatePreviewStoreConfiguration = function(widgetIndex, config) {\r\n         if (typeof config != typeof {}) {\r\n             return;\r\n         }\r\n         return sendPreviewStoreConfiguration(widgetIndex, config);\r\n     }\r\n \r\n     w.updateExternalDataProductDetails = function(widgetIndex, externalProductData) {\r\n         if (typeof externalProductData != typeof {}) {\r\n             return;\r\n         }\r\n         return sendExternalProductData(widgetIndex, externalProductData);\r\n     }\r\n \r\n     w.updatePreviewWidgetSize = updateWidgetSize;\r\n \r\n \r\n    //  if (!w.ec) {\r\n    //      w.ec = {\r\n    //          getString: function(key) {\r\n    //              return rosettaMessages['new-frontend'][key];\r\n    //          }\r\n    //      }\r\n    //  }\r\n \r\n     function sendLookAndFeelConfig(widgetIndex, config) {\r\n         var preview = getPreview(widgetIndex);\r\n         if (!preview) {\r\n             return false;\r\n         }\r\n         if (preview.ports.overrideStorefrontLookAndFeel) {\r\n             preview.ports.overrideStorefrontLookAndFeel.send(JSON.stringify(config));\r\n         }\r\n         return true;\r\n     }\r\n \r\n     function sendPreviewStoreConfiguration(widgetIndex, storeConfig) {\r\n         var preview = getPreview(widgetIndex);\r\n         if (!preview) {\r\n             return false;\r\n         }\r\n         if (preview.ports.configResponse) {\r\n             preview.ports.configResponse.send(JSON.stringify(storeConfig));\r\n         }\r\n         return true;\r\n     }\r\n \r\n     function sendExternalProductData(widgetIndex, externalProductData) {\r\n         var preview = getPreview(widgetIndex);\r\n         if (!preview) {\r\n             return false;\r\n         }\r\n         if (preview.ports.productResponse) {\r\n             preview.ports.productResponse.send(JSON.stringify(externalProductData));\r\n         }\r\n         return true;\r\n     }\r\n \r\n     function load() {\r\n         updateWidgetSize();\r\n     }\r\n \r\n     function updateWidgetSize() {\r\n         for (var property in widgets) {\r\n             if (widgets.hasOwnProperty(property)) {\r\n                 var node = widgets[property].node\r\n                 var preview = getPreview(property)\r\n                 preview.ports.onContainerResize.send(JSON.stringify({browserWidth:node.offsetWidth}))\r\n             }\r\n         }\r\n     }\r\n \r\n \r\n     function getPreview(id) {\r\n         return widgets[id] && widgets[id].preview\r\n     }\r\n \r\n })(window);\r\n "]},"metadata":{},"sourceType":"module"}